<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Insight Capture - Mission Discovery | ScaleOps6</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(135deg, #FF5500 0%, #FF8800 100%);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo { font-size: 1.5rem; font-weight: bold; }
        .nav { display: flex; gap: 2rem; }
        .nav a { color: white; text-decoration: none; }
        .breadcrumb {
            padding: 1rem 2rem;
            color: #888;
            font-size: 0.9rem;
        }
        .breadcrumb a { color: #FF5500; text-decoration: none; }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .subcomponent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(255,85,0,0.1) 0%, rgba(255,136,0,0.1) 100%);
            border-radius: 12px;
        }
        .subcomponent-badge {
            display: inline-block;
            background: #FF5500;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        .agent-info {
            color: #888;
            margin-top: 0.5rem;
        }
        .score-circle {
            position: relative;
            width: 120px;
            height: 120px;
        }
        .score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        .score-value {
            display: block;
            font-size: 2rem;
            font-weight: bold;
            color: #FF5500;
        }
        .score-label {
            display: block;
            font-size: 0.75rem;
            color: #888;
        }
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid #333;
        }
        .tab {
            background: none;
            border: none;
            color: #888;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .tab.active {
            color: #FF5500;
            border-bottom: 2px solid #FF5500;
        }
        .tab-pane {
            display: none;
        }
        .tab-pane.active {
            display: block;
        }
        .content-section {
            background: #111;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        .content-section h3 {
            color: #FF5500;
            margin-bottom: 1rem;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #ccc;
        }
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            background: #111;
            border: 1px solid #333;
            border-radius: 6px;
            color: white;
        }
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        .required {
            color: #FF5500;
        }
        .submit-btn {
            background: linear-gradient(135deg, #FF5500, #FF8800);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .analysis-grid {
            display: grid;
            gap: 2rem;
        }
        .analysis-card {
            background: #111;
            padding: 1.5rem;
            border-radius: 8px;
        }
        .dimension {
            margin-bottom: 1.5rem;
        }
        .dimension-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        .dimension-bar {
            height: 8px;
            background: #222;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        .dimension-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF5500, #FF8800);
        }
        .dimension-desc {
            font-size: 0.85rem;
            color: #888;
        }
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        .resource-card {
            background: #111;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }
        .resource-card i {
            font-size: 2rem;
            color: #FF5500;
            margin-bottom: 1rem;
        }
        .history-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 2rem;
        }
        .stat {
            text-align: center;
        }
        .stat-value {
            display: block;
            font-size: 2rem;
            font-weight: bold;
            color: #FF5500;
        }
        .stat-label {
            display: block;
            font-size: 0.85rem;
            color: #888;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <img src="ScaleOps6_logo.png" alt="ScaleOps6" style="height: 40px;">
        </div>
        <nav class="nav">
            <a href="index.html">Dashboard</a>
            <a href="block-1-mission-discovery.html">Block 1</a>
            <a href="#">Settings</a>
        </nav>
    </div>

    <div class="breadcrumb">
        <a href="index.html">Dashboard</a> / 
        <a href="block-1-mission-discovery.html">Block 1: Mission Discovery</a> / 
        1C: Voice of Customer
    </div>

    <div class="container">
        <div class="subcomponent-header">
            <div class="header-content">
                <span class="subcomponent-badge">1C</span>
                <h1>Customer Insight Capture</h1>
                <p class="agent-info">
                    <i class="fas fa-robot"></i> Expert Agent: VoC Synthesizer
                </p>
            </div>
            <div class="score-display">
                <div class="score-circle">
                    <svg width="120" height="120">
                        <circle cx="60" cy="60" r="54" stroke="#333" stroke-width="8" fill="none"/>
                        <circle cx="60" cy="60" r="54" stroke="#FF5500" stroke-width="8" fill="none"
                                stroke-dasharray="339.292" stroke-dashoffset="100"
                                transform="rotate(-90 60 60)"/>
                    </svg>
                    <div class="score-text">
                        <span class="score-value">72</span>
                        <span class="score-label">Score</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="education">
                <i class="fas fa-graduation-cap"></i> Education
            </button>
            <button class="tab" data-tab="workspace">
                <i class="fas fa-edit"></i> Workspace
            </button>
            <button class="tab" data-tab="analysis">
                <i class="fas fa-chart-line"></i> Analysis
            </button>
            <button class="tab" data-tab="resources">
                <i class="fas fa-book"></i> Resources
            </button>
            <button class="tab" data-tab="history">
                <i class="fas fa-history"></i> Score History
            </button>
        </div>

        <div class="tab-content">
            <div id="education" class="tab-pane active">
                
            <div class="content-section">
                <h3>What is Customer Insight Capture?</h3>
                <p>Raw and synthesized data directly from your target users, derived from interviews, field studies, support transcripts, or usage analytics.</p>
                
                <h3>Why It Matters</h3>
                <p>You cannot build, sell, or scale effectively without truly understanding your customers' language, emotions, and workflows. This is the source of all strategy.</p>
                
                <h3>How to Implement</h3>
                
      <h4>Data Collection Methods:</h4>
      <ul>
        <li><strong>Customer interviews</strong> - 30-45 minute structured conversations</li>
        <li><strong>Field studies</strong> - Observe users in their natural environment</li>
        <li><strong>Support analysis</strong> - Mine tickets for patterns</li>
        <li><strong>Usage analytics</strong> - Track actual behavior vs. stated preferences</li>
        <li><strong>Surveys</strong> - Quantify qualitative insights at scale</li>
      </ul>
      
      <h4>Synthesis Framework:</h4>
      <ol>
        <li>Conduct at least 5 interviews per persona</li>
        <li>Identify pain themes and trigger events</li>
        <li>Map language patterns and emotional drivers</li>
        <li>Extract behavioral insights, not just opinions</li>
        <li>Document "day in the life" workflows</li>
        <li>Identify gaps between expectations and reality</li>
      </ol>
      
      <h4>Organization System:</h4>
      <ul>
        <li>Create a tagged insight database (Notion/Airtable)</li>
        <li>Categorize by persona, pain point, and frequency</li>
        <li>Link insights to product decisions</li>
        <li>Update quarterly with fresh research</li>
      </ul>
    
                
                
                <h3>Examples</h3>
                <ul>
                    <li>Discovery: 73% of HR managers mentioned 'compliance anxiety' unprompted</li><li>Pattern: Users attempt workarounds 3-4 times before contacting support</li><li>Quote: 'I'd pay $500/month just to never think about this again'</li>
                </ul>
                
                
                
                <h3>Key Metrics</h3>
                <ul>
                    <li>Number of insights collected</li><li>Insight-to-action conversion rate</li><li>Customer validation percentage</li><li>Time to insight discovery</li>
                </ul>
                
            </div>
        
            </div>
            </div>

            <div id="workspace" class="tab-pane">
                <!-- Dynamic worksheet will be injected here -->
                <div class="loading-message" style="text-align: center; padding: 2rem; color: #888;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <p>Loading interactive worksheet...</p>
                </div>
            </div>
                
                    <div class="dimension-card">
                        <h4>Quality</h4>
                        <p>Quality and effectiveness of implementation</p>
                        <div class="score-display">
                            <span class="score-value">0</span>
                            <span class="score-label">/ 100</span>
                        </div>
                        <div class="weight-info">Weight: 20%</div>
                    </div>
                
                    <div class="dimension-card">
                        <h4>Strategic Alignment</h4>
                        <p>Alignment with business objectives</p>
                        <div class="score-display">
                            <span class="score-value">0</span>
                            <span class="score-label">/ 100</span>
                        </div>
                        <div class="weight-info">Weight: 20%</div>
                    </div>
                
                    <div class="dimension-card">
                        <h4>Adoption/Usage</h4>
                        <p>Level of adoption and regular usage</p>
                        <div class="score-display">
                            <span class="score-value">0</span>
                            <span class="score-label">/ 100</span>
                        </div>
                        <div class="weight-info">Weight: 20%</div>
                    </div>
                
                    <div class="dimension-card">
                        <h4>Business Impact</h4>
                        <p>Measurable impact on business outcomes</p>
                        <div class="score-display">
                            <span class="score-value">0</span>
                            <span class="score-label">/ 100</span>
                        </div>
                        <div class="weight-info">Weight: 20%</div>
                    </div>
                
            </div>
            <div class="overall-score">
                <h3>Overall Score</h3>
                <div class="score-circle">
                    <span class="score-number">0</span>
                    <span class="score-label">/ 100</span>
                </div>
            </div>
        
            </div>
                <p class="dimension-desc">Quality and quantity of customer input</p>
            </div>
        
            <div class="dimension">
                <div class="dimension-header">
                    <span class="dimension-name">Pattern Recognition</span>
                    <span class="dimension-score">19/20</span>
                </div>
                <div class="dimension-bar">
                    <div class="dimension-fill" style="width: 89.02583268432312%"></div>
                </div>
                <p class="dimension-desc">Ability to identify key themes</p>
            </div>
        
            <div class="dimension">
                <div class="dimension-header">
                    <span class="dimension-name">Insight Depth</span>
                    <span class="dimension-score">16/20</span>
                </div>
                <div class="dimension-bar">
                    <div class="dimension-fill" style="width: 71.07633655167528%"></div>
                </div>
                <p class="dimension-desc">Quality of insights extracted</p>
            </div>
        
            <div class="dimension">
                <div class="dimension-header">
                    <span class="dimension-name">Actionability</span>
                    <span class="dimension-score">16/20</span>
                </div>
                <div class="dimension-bar">
                    <div class="dimension-fill" style="width: 72.46287601844111%"></div>
                </div>
                <p class="dimension-desc">Clarity of next steps from insights</p>
            </div>
        
            <div class="dimension">
                <div class="dimension-header">
                    <span class="dimension-name">Coverage</span>
                    <span class="dimension-score">17/20</span>
                </div>
                <div class="dimension-bar">
                    <div class="dimension-fill" style="width: 61.97767060982947%"></div>
                </div>
                <p class="dimension-desc">Breadth of customer segments covered</p>
            </div>
        
                            </div>
                        </div>
                        <div class="analysis-card">
                            <h3>Key Findings</h3>
                            
            <div class="findings">
                <h4 style="color: #4CAF50; margin-bottom: 1rem;">✅ Strengths</h4>
                
                    <div class="finding positive" style="margin: 0.5rem 0;">
                        <i class="fas fa-check-circle"></i>
                        <span>Clear understanding of customer feedback and insights</span>
                    </div>
                
                    <div class="finding positive" style="margin: 0.5rem 0;">
                        <i class="fas fa-check-circle"></i>
                        <span>Systematic approach in place</span>
                    </div>
                
                    <div class="finding positive" style="margin: 0.5rem 0;">
                        <i class="fas fa-check-circle"></i>
                        <span>Data-driven decision making</span>
                    </div>
                
                
                <h4 style="color: #FF9800; margin: 1.5rem 0 1rem 0;">⚠️ Areas for Improvement</h4>
                
                    <div class="finding warning" style="margin: 0.5rem 0;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Limited validation or evidence</span>
                    </div>
                
                    <div class="finding warning" style="margin: 0.5rem 0;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Inconsistent implementation</span>
                    </div>
                
                    <div class="finding warning" style="margin: 0.5rem 0;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Lack of clear metrics</span>
                    </div>
                
                
                <h4 style="color: #2196F3; margin: 1.5rem 0 1rem 0;">💡 Opportunities</h4>
                
                    <div class="finding info" style="margin: 0.5rem 0;">
                        <i class="fas fa-lightbulb"></i>
                        <span>Enhance customer feedback and insights capabilities</span>
                    </div>
                
                    <div class="finding info" style="margin: 0.5rem 0;">
                        <i class="fas fa-lightbulb"></i>
                        <span>Implement best practices</span>
                    </div>
                
                    <div class="finding info" style="margin: 0.5rem 0;">
                        <i class="fas fa-lightbulb"></i>
                        <span>Leverage automation and tools</span>
                    </div>
                
            </div>
        
                        </div>
                    </div>
                </div>
            </div>

            <div id="resources" class="tab-pane">
                
            <div class="resources-grid">
                
                    <div class="resource-section">
                        <h3>Recommended Tools</h3>
                        <ul>
                            <li>Transcription Tools (Otter.ai, Rev)</li><li>Insight Management (Dovetail, Aurelius)</li><li>Analytics Platforms (Fullstory, Hotjar)</li><li>CRM Systems (HubSpot, Salesforce)</li>
                        </ul>
                    </div>
                
                    <div class="resource-section">
                        <h3>Templates & Frameworks</h3>
                        <ul>
                            <li>Customer Interview Script</li><li>Insight Synthesis Canvas</li><li>Voice of Customer Database</li><li>Insight Tagging Framework</li>
                        </ul>
                    </div>
                
                    <div class="resource-section">
                        <h3>Best Practices</h3>
                        <ul>
                            <li>Record and transcribe all customer conversations</li><li>Tag insights immediately after collection</li><li>Share insights weekly with entire team</li><li>Link insights directly to product decisions</li>
                        </ul>
                    </div>
                
            </div>
        
            </div>
        
            </div>
        
                </div>
            </div>

            <div id="history" class="tab-pane">
                <div class="history-content">
                    <h2>Score History & Trends</h2>
                    <div class="chart-container">
                        <canvas id="scoreChart"></canvas>
                    </div>
                    <div class="history-stats">
                        <div class="stat">
                            <span class="stat-value">+15%</span>
                            <span class="stat-label">30-Day Change</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">72</span>
                            <span class="stat-label">Current Score</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">85</span>
                            <span class="stat-label">Target Score</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Enhanced Display Handler for Voice of Customer -->
    <script src="enhanced-display-handler.js"></script>
    <script src="dynamic-worksheet-generator.js"></script>
    <script src="question-bank-system.js"></script>
    <script src="subcomponent-agent-factory.js"></script>
    <script src="worksheet-library.js"></script>
    <script src="worksheet-integration.js"></script>
    <script src="learning-system.js"></script>

    <script>
        
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;
                
                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update active pane - Use tab-pane class consistently
                document.querySelectorAll('.tab-pane').forEach(pane => {
                    pane.classList.remove('active');
                    pane.style.display = 'none';
                });
                const targetPane = document.getElementById(tabName);
                if (targetPane) {
                    targetPane.classList.add('active');
                    targetPane.style.display = 'block';
                    console.log(`✅ Activated pane: ${tabName}`);
                } else {
                    console.error(`❌ Could not find pane with id: ${tabName}`);
                }
            });
        });

        // Form submission with analysis
        document.getElementById('worksheetForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            console.log('📝 Voice of Customer form submitted - starting analysis');

            // Collect form data
            const formData = new FormData(e.target);
            const worksheetData = {};

            // Map form fields to expected worksheet keys
            const fieldMapping = {
                'current_state': 'who-affected',
                'target_outcome': 'what-problem',
                'key_challenges': 'when-occur',
                'timeline': 'what-impact',
                'resources_needed': 'how-solving',
                'success_metrics': 'evidence-validation'
            };

            for (let [key, value] of formData.entries()) {
                const mappedKey = fieldMapping[key] || key;
                worksheetData[mappedKey] = value;
                console.log(`📋 Field ${key} -> ${mappedKey}: ${value.substring(0, 50)}...`);
            }

            console.log('🔍 Sending analysis request to server...');
            console.log('📦 Worksheet data:', worksheetData);

            try {
                // Call the analysis API
                const response = await fetch('/api/analyze/customer-insight', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-user-id': '1'
                    },
                    body: JSON.stringify({
                        worksheetData: worksheetData,
                        subcomponentId: '1-3'
                    })
                });

                console.log(`📡 Response status: ${response.status}`);

                if (!response.ok) {
                    throw new Error(`Analysis failed: ${response.statusText}`);
                }

                const analysis = await response.json();
                console.log('✅ Analysis received:', analysis);
                console.log('📊 Score:', analysis.score);
                console.log('🎯 Recommendations:', analysis.recommendations?.length || 0);

                // Display the analysis results using the enhanced display function
                if (window.displayEnhancedAnalysisResults) {
                    window.displayEnhancedAnalysisResults(analysis, 'voice-of-customer');
                } else {
                    console.error('❌ Enhanced display function not available');
                    alert('Display function not available. Please refresh the page.');
                }

                // Switch to analysis tab
                console.log('🔄 Switching to Analysis tab...');
                document.querySelector('[data-tab="analysis"]').click();

            } catch (error) {
                console.error('❌ Analysis error:', error);
                alert('Analysis failed: ' + error.message);
            }
        });

        // Simulate score animation
        setTimeout(() => {
            const circle = document.querySelector('circle:last-child');
            if (circle) {
                circle.style.transition = 'stroke-dashoffset 1s ease';
                circle.style.strokeDashoffset = '95';
            }
        }, 500);
    </script>
</body>
</html>