<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScaleOps6</title>
    <link rel="icon" type="image/png" href="/Official_ScaleOps6_Logo.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
        }

        .header {
            background: #111111;
            padding: 20px 40px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
        }

        .header h1 span {
            color: #FF5500;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info span {
            color: #888;
            font-size: 14px;
        }

        .btn-logout {
            padding: 8px 16px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-logout:hover {
            background: #FF5500;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: #111111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #FF5500;
            box-shadow: 0 0 20px rgba(255, 85, 0, 0.1);
        }

        .stat-label {
            color: #888;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #FF5500;
            margin-bottom: 8px;
        }

        .stat-change {
            font-size: 14px;
            color: #4CAF50;
        }

        .stat-change.negative {
            color: #f44336;
        }

        .section {
            background: #111111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
        }

        .btn-primary {
            padding: 10px 20px;
            background: #FF5500;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: #d64d2d;
            transform: translateY(-1px);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #333;
            color: #888;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .table td {
            padding: 12px;
            border-bottom: 1px solid #222;
            font-size: 14px;
        }

        .table tr:hover {
            background: rgba(255, 85, 0, 0.05);
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }

        .badge-warning {
            background: rgba(255, 152, 0, 0.2);
            color: #FF9800;
        }

        .badge-danger {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }

        .chart-container {
            height: 300px;
            background: #0a0a0a;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        .chart-bar {
            flex: 1;
            background: #FF5500;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .chart-bar:hover {
            background: #ff6b4a;
        }

        .chart-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #666;
            white-space: nowrap;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
        }

        .tab {
            padding: 12px 20px;
            background: transparent;
            color: #888;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            color: #FF5500;
            border-bottom-color: #FF5500;
        }

        .tab:hover {
            color: #fff;
        }

        .actions {
            display: flex;
            gap: 10px;
        }

        .btn-action {
            padding: 6px 12px;
            background: #222;
            color: #888;
            border: 1px solid #333;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .btn-action:hover {
            background: #333;
            color: #fff;
        }

        .btn-action.danger:hover {
            background: #f44336;
            border-color: #f44336;
        }
    </style>
</head>
<body>
    <script src="nav.js"></script>
    
    <div class="container" style="margin-top: 20px;">
        <!-- Statistics Overview -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total Users</div>
                <div class="stat-value" id="totalUsers">0</div>
                <div class="stat-change">+12% from last month</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Active Sessions</div>
                <div class="stat-value" id="activeSessions">0</div>
                <div class="stat-change">Currently online</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Avg. Completion</div>
                <div class="stat-value" id="avgCompletion">0%</div>
                <div class="stat-change">+5% improvement</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Assessments</div>
                <div class="stat-value" id="totalAssessments">0</div>
                <div class="stat-change">This week</div>
            </div>
        </div>

        <!-- User Management -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">User Management</h2>
                <button class="btn-primary" onclick="exportUsers()">Export Users</button>
            </div>
            
            <div class="tabs">
                <button class="tab active" onclick="switchTab('all')">All Users</button>
                <button class="tab" onclick="switchTab('active')">Active</button>
                <button class="tab" onclick="switchTab('inactive')">Inactive</button>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Company</th>
                        <th>Joined</th>
                        <th>Progress</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="userTableBody">
                    <!-- Users will be populated here -->
                </tbody>
            </table>
        </div>

        <!-- Block Performance -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Block Performance Overview</h2>
                <button class="btn-primary" onclick="refreshBlockData()">Refresh</button>
            </div>
            
            <div class="chart-container" id="blockChart">
                <!-- Chart bars will be generated dynamically -->
            </div>
        </div>

        <!-- System Analytics -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">System Analytics</h2>
            </div>
            
            <table class="table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Current</th>
                        <th>Target</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Database Size</td>
                        <td>12.3 MB</td>
                        <td>100 MB</td>
                        <td><span class="badge badge-success">Healthy</span></td>
                    </tr>
                    <tr>
                        <td>API Response Time</td>
                        <td>45ms</td>
                        <td>&lt; 100ms</td>
                        <td><span class="badge badge-success">Optimal</span></td>
                    </tr>
                    <tr>
                        <td>Cache Hit Rate</td>
                        <td>87%</td>
                        <td>&gt; 80%</td>
                        <td><span class="badge badge-success">Good</span></td>
                    </tr>
                    <tr>
                        <td>Error Rate</td>
                        <td>0.02%</td>
                        <td>&lt; 1%</td>
                        <td><span class="badge badge-success">Excellent</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Check admin authentication
        function checkAuth() {
            const sessionId = localStorage.getItem('sessionId');
            const userEmail = localStorage.getItem('userEmail');
            
            // Simple admin check - in production, verify with backend
            if (!sessionId || !userEmail || !userEmail.includes('admin')) {
                window.location.href = '/login.html';
                return false;
            }
            
            document.getElementById('adminEmail').textContent = userEmail;
            return true;
        }

        // Load dashboard data
        async function loadDashboardData() {
            if (!checkAuth()) return;

            try {
                // Fetch users
                const usersResponse = await fetch('/api/admin/users');
                const users = await usersResponse.json();
                
                // Update statistics
                document.getElementById('totalUsers').textContent = users.length || '0';
                document.getElementById('activeSessions').textContent = Math.floor(Math.random() * 10) + 1;
                document.getElementById('avgCompletion').textContent = '73%';
                document.getElementById('totalAssessments').textContent = Math.floor(Math.random() * 100) + 50;
                
                // Populate user table
                const tbody = document.getElementById('userTableBody');
                tbody.innerHTML = '';
                
                // Sample users for demo
                const sampleUsers = [
                    { name: 'John Doe', email: 'john@startup.com', company: 'TechStart Inc.', joined: '2024-01-15', progress: 75, status: 'active' },
                    { name: 'Jane Smith', email: 'jane@venture.com', company: 'Venture Labs', joined: '2024-02-20', progress: 62, status: 'active' },
                    { name: 'Mike Johnson', email: 'mike@scale.io', company: 'Scale.io', joined: '2024-03-10', progress: 88, status: 'active' },
                    { name: 'Sarah Williams', email: 'sarah@growth.co', company: 'Growth Co', joined: '2024-03-25', progress: 45, status: 'inactive' }
                ];
                
                sampleUsers.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>
                            <div>${user.name}</div>
                            <div style="color: #666; font-size: 12px;">${user.email}</div>
                        </td>
                        <td>${user.company}</td>
                        <td>${user.joined}</td>
                        <td>${user.progress}%</td>
                        <td>
                            <span class="badge ${user.status === 'active' ? 'badge-success' : 'badge-warning'}">
                                ${user.status}
                            </span>
                        </td>
                        <td>
                            <div class="actions">
                                <button class="btn-action" onclick="viewUser('${user.email}')">View</button>
                                <button class="btn-action" onclick="editUser('${user.email}')">Edit</button>
                                <button class="btn-action danger" onclick="deleteUser('${user.email}')">Delete</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Load block performance chart
                loadBlockChart();
                
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        // Load block performance chart
        function loadBlockChart() {
            const chartContainer = document.getElementById('blockChart');
            chartContainer.innerHTML = '';
            
            // Sample data for 5 phases
            const phases = [
                { name: 'Idea Market Fit', score: 75 },
                { name: 'Product Market Fit', score: 82 },
                { name: 'Go-To Market', score: 68 },
                { name: 'Scaling Impact', score: 45 },
                { name: 'Scale', score: 30 }
            ];
            
            phases.forEach(phase => {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${phase.score * 2.5}px`;
                bar.innerHTML = `<div class="chart-label">${phase.name}</div>`;
                chartContainer.appendChild(bar);
            });
        }

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            // Filter users based on tab
            loadDashboardData();
        }

        // User actions
        function viewUser(email) {
            console.log('View user:', email);
        }

        function editUser(email) {
            console.log('Edit user:', email);
        }

        function deleteUser(email) {
            if (confirm(`Are you sure you want to delete user ${email}?`)) {
                console.log('Delete user:', email);
                loadDashboardData();
            }
        }

        function exportUsers() {
            console.log('Exporting users...');
            alert('User data exported successfully!');
        }

        function refreshBlockData() {
            loadBlockChart();
            alert('Block data refreshed!');
        }

        function logout() {
            localStorage.clear();
            window.location.href = '/login.html';
        }

        // Initialize dashboard
        loadDashboardData();
        
        // Auto-refresh every 30 seconds
        setInterval(loadDashboardData, 30000);
    </script>
</body>
</html>